{% extends 'shared/_MainLayout.html' %}
{% load static %}

{% block title %}مشخصات گیگ{% endblock %}

{% block content %}


    <section>
        <div class="container">
            <div class="row">

                <div class="col-sm-12">
                    <div class="product-details"><!--product-details-->
                        <div class="col-sm-5">
                            <div class="view-product">
                                {% if gig.image %}
                                    <img src="{{ gig.image.url }}" alt=""
                                         style="border-color:#42075b;border-width: 5px;">
                                    <a href="{{ gig.image.url }}"><h3>دانلود عکس</h3></a>
                                {% else %}
                                    <img src="{% static 'images/product-details/1.jpg' %}"
                                         alt="" style="border-color:#42075b;border-width: 5px;>
                                {% endif %}
                            </div>
                            <div id=" similar-product" class="carousel slide" data-ride="carousel">

                                <!-- Wrapper for slides -->
                                <div class="carousel-inner">
                                    <div class="item">
                                    </div>
                                    <div class="item active">
                                    </div>
                                    <div class="item">
                                    </div>

                                </div>

                            </div>

                        </div>
                        <div class="col-sm-7">
                            <div class="product-information"><!--/product-information-->
                                <img src="{% static 'images/product-details/new.png' %}" class="newarrival" alt="">
                                <div>
                                    <h2>{{ gig.title }}</h2>

                                </div>
                                <div>
									<span>
										<span>قیمت : {{ gig.re_format_cost }} تومان</span>
									</span>
                                    {% if not request.user == gig.user %}
                                        <form method="post" action="{% url 'order:add-order' %}">
                                            {% csrf_token %}
                                            <span>
                                    <label> مهلت به روز :</label>
                                        {{ order_form.deadline }}
                                        {{ order_form.gig_id }}
                                                {% for error in order_form.deadline.errors %}
                                                    <p style="color: red">{{ error }}</p>
                                                    <br>
                                                {% endfor %}
                                    </span><br><br>

                                            <button type="submit" class="btn btn-fefault cart pull-right">
                                                <i class="fa fa-shopping-cart"></i>
                                                افـزودن به سبـد خریـد
                                            </button>
                                        </form>
                                    {% else %}
                                        <br><br>  <a href="{% url 'gig:edit_gig' gig.id %}">
                                        <button class="btn" style="background-color: #42075b;color: whitesmoke">
                                            ویرایش گیگ
                                        </button>
                                    </a>

                                    {% endif %}
                                </div>
                                <br>
                                <div><br><br>
                                    <p style="text-align: justify; line-height: 30px;font-size: 15px"><b>وضعیت ارائه
                                        دهنده :</b> فعال</p>
                                    <p style="text-align: justify; line-height: 30px;font-size: 15px"><b>نام و نام
                                        خانوادگی : </b><a
                                            href="{% url 'proFile:profile' gig.user.id %}">{{ gig.user.get_full_name }} </a>
                                    </p>
                                    <p style="text-align: justify; line-height: 30px;font-size: 15px"><b>گروه مربوطه
                                        : </b><a
                                            href="/gigs/grouping/{{ gig.field.title }}">{{ gig.field.title }} </a>
                                    </p>
                                </div>
                                <br>

                            </div><!--/product-information-->
                        </div>
                    </div><!--/product-details-->

                    <div class="category-tab shop-details-tab"><!--category-tab-->

                        <div class="col-sm-12">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#details" data-toggle="tab">جزئیات</a></li>
                                <li><a href="#reviews" data-toggle="tab">نظرات ({{ comments|length }})</a></li>
                            </ul>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane fade active in" id="details">
                                <div class="col-md-12">
                                    <p style="text-align: justify; line-height: 30px;font-size: 18px">
                                        <b>{{ gig.description }}</b></p>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="reviews">
                                <br>
                                <h2 class="text-center"><b style="color: red">{{ comments|length }}</b>دیدگاه برای این
                                    گیگ ثبت شده است. </h2>
                                <div class="col-sm-12">


                                    {% for comment in comments %}
                                        <div style="-radius:10px ;: solid 2px #42075b;padding: 10px;">

                                            <ul>
                                                <li><a href=""><i class="fa fa-user"></i>{{ comment.user }}</a></li>
                                                <li><a href=""><i class="fa fa-clock-o"></i> {{ comment.get_time }}</a>
                                                </li>
                                                <li><a href=""><i class="fa fa-calendar-o"></i> {{ comment.get_date }}
                                                </a></li>
                                            </ul>
                                            <p style="font-size: 18px">{{ comment.content }}</p><br>

                                            {% if gig in gig_list or request.user == gig.user %}
                                                <a href="{% url 'comments:reply-comment' comment.id %}">
                                                    <button type="submit">پاسخ</button>
                                                </a>
                                            {% endif %}
                                            {% if request.user == comment.user %}
                                                <a href="{% url 'comments:delete-comment' comment.id gig.id %}">
                                                    <button type="submit">حذف</button>
                                                </a>
                                                <a href="{% url 'comments:update-comment' comment.id %}">
                                                    <button type="submit">ویرایش</button>
                                                </a>
                                            {% endif %}

                                            <br>
                                            {% for reply in comment.comment_set.all %}


                                                <div style="-radius:0px ;: solid 2px #575757;padding: 30px; margin-right:100px ">
                                                    <ul><h5>در پاسخ به <b
                                                            style="color: #d00202">{{ comment.user.username }}</b></h5>
                                                        <li><a href=""><i class="fa fa-user"></i>{{ reply.user }}</a>
                                                        </li>
                                                        <li><a href=""><i
                                                                class="fa fa-clock-o"></i> {{ reply.get_time }}</a>
                                                        </li>
                                                        <li><a href=""><i
                                                                class="fa fa-calendar-o"></i> {{ reply.get_date }}
                                                        </a></li>
                                                    </ul>
                                                    <p style="font-size: 18px">{{ reply.content }}</p>

                                                    {% if gig in gig_list or request.user == gig.user %}
                                                        <a href="{% url 'comments:reply-comment' reply.id %}">
                                                            <button type="submit" style="background-color: #298aa8">پاسخ
                                                            </button>
                                                        </a>
                                                    {% endif %}
                                                    {% if request.user == reply.user %}
                                                        <a href="{% url 'comments:delete-comment' reply.id gig.id %}">
                                                            <button type="submit" style="background-color: #298aa8">حذف
                                                            </button>
                                                        </a>
                                                        <a href="{% url 'comments:update-comment' reply.id %}">
                                                            <button type="submit" style="background-color: #298aa8">
                                                                ویرایش
                                                            </button>
                                                        </a>
                                                    {% endif %}


                                                    {% for re_reply in reply.comment_set.all %}
                                                        <div style="-radius:0px ;: solid 2px #575757;padding: 30px; margin:20px 100px 0px 0px ">
                                                            <ul><h5>در پاسخ به <b
                                                                    style="color: #d00202">{{ reply.user.username }}</b>
                                                            </h5>
                                                                <li><a href=""><i
                                                                        class="fa fa-user"></i>{{ re_reply.user }}</a>
                                                                </li>
                                                                <li><a href=""><i
                                                                        class="fa fa-clock-o"></i> {{ re_reply.get_time }}
                                                                </a>
                                                                </li>
                                                                <li><a href=""><i
                                                                        class="fa fa-calendar-o"></i> {{ re_reply.get_date }}
                                                                </a></li>
                                                            </ul>
                                                            <p style="font-size: 18px">{{ re_reply.content }}</p>
                                                            {% if gig in gig_list or request.user == gig.user %}
                                                                <a href="{% url 'comments:reply-comment' re_reply.id %}">
                                                                    <button type="submit"
                                                                            style="background-color: #298aa8">
                                                                        پاسخ
                                                                    </button>
                                                                </a>
                                                            {% endif %}
                                                            {% if request.user == reply.user %}
                                                                <a href="{% url 'comments:delete-comment' re_reply.id gig.id %}">
                                                                    <button type="submit"
                                                                            style="background-color: #298aa8">
                                                                        حذف
                                                                    </button>
                                                                </a>
                                                                <a href="{% url 'comments:update-comment' re_reply.id %}">
                                                                    <button type="submit"
                                                                            style="background-color: #298aa8">
                                                                        ویرایش
                                                                    </button>
                                                                </a>
                                                            {% endif %}

                                                        </div>

                                                    {% endfor %}

                                                </div>

                                            {% endfor %}

                                        </div>

                                        <br>

                                        <hr style="border-width: 2px;border-color: #5d5f5e;opacity: 50%">
                                    {% endfor %}
                                </div>

                                {% if gig in gig_list %}

                                    <p style="font-size: 20px"><b>نظـر خود را بنویسیـد</b></p>
                                    <br><br>

                                    <form action="{% url 'comments:add-comment' %}" method="POST">
                                        {% csrf_token %}
                                        <p style="font-size: 18px"><b>
                                            {{ comment_form.content.label }} :
                                        </b></p>
                                        {{ comment_form.content }}
                                        {{ comment_form.gig_id }}
                                        <button type="submit" class="btn btn-default pull-left">
                                            ارسال
                                        </button>
                                    </form>
                                {% elif not request.user.is_authenticated %}
                                    <h2 class="text-center">


                                            برای ایجاد دیدگاه ابتدا <b style="color: #9e1f1f"><a href="/accounts/login?next={{ request.path }}" style="color: #922222">{{ message }}</a>
                                        </b>

                                    </h2>
                                {% elif request.user != gig.user %}
                                    <h2 class="text-center">
                                        برای ایجاد دیدگاه ابتدا <b style="color: firebrick">{{ message }}</b>
                                    </h2>
                                {% endif %}

                            </div>
                        </div>
                    </div>
                </div><!--/category-tab-->
            </div>
        </div>
    </section>

{% endblock %}
